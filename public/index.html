<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Guernsey Covid-19 Tracker</title>
    <meta name="google-site-verification" content="8piRUSWRxw32V06Sgtlp6P154T_YZOL0Q9N_mPtcFDM" />

    <!-- update the version number as needed -->
    <script defer src="/__/firebase/7.10.0/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/7.10.0/firebase-analytics.js"></script>
    <script defer src="/__/firebase/init.js"></script>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.0.2/css/adminlte.min.css"
      integrity="sha256-tDEOZyJ9BuKWB+BOSc6dE4cI0uNznodJMx11eWZ7jJ4="
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
      integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
      crossorigin="anonymous"
    />
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet" />

    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script src="js/main.js"></script>

    <!--link rel="stylesheet" type="text/css" href="css/style.css" media="screen" /-->
    <link rel="stylesheet" type="text/css" href="css/main.css" media="screen" />
  </head>

  <body class="hold-transition layout-top-nav">
    <div class="wrapper">
      <!-- Navbar -->
      <nav class="main-header navbar navbar-expand-md navbar-light navbar-white">
        <div class="container">
          <a href="index.html" class="navbar-brand">
            <span class="brand-text font-weight-light">Guernsey Covid-19 Tracker</span>
          </a>
          <button
            class="navbar-toggler order-1"
            type="button"
            data-toggle="collapse"
            data-target="#navbarCollapse"
            aria-controls="navbarCollapse"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>

          <ul class="order-1 order-md-3 navbar-nav navbar-no-expand ml-auto">
            <li class="nav-item">
              <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modal-about">
                About
              </button>
            </li>
          </ul>
        </div>
      </nav>
      <!-- /.navbar -->

      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <div class="content-header">
          <div class="container">
            <div class="row mb-2">
              <div class="col-sm-6">
                <h3 class="m-0 text-dark">Live Covid-19 Tracking for Guernsey</h3>
              </div>
              <!-- /.col -->
            </div>
            <!-- /.row -->
          </div>
          <!-- /.container-fluid -->
        </div>
        <!-- /.content-header -->

        <!-- Main content -->
        <div class="content">
          <div class="container">

            <!-- Current figures -->
            <div class="d-flex flex-column flex-md-row currentNumbers">
              <div class="flex-fill py-sm-0 pr-md-2">
                <div class="small-box bg-info">
                  <div class="overlay dark ggLoading">
                    <i class="fas fa-3x fa-sync-alt"></i>
                  </div>
                  <div class="inner">
                    <h3 id="currentTotal">-</h3>
                    <p>Total tested</p>
                  </div>
                  <div class="icon">
                    <i class="fas fa-vial"></i>
                  </div>
                </div>
              </div>

              <div class="flex-fill py-sm-0 px-md-2">
                <div class="small-box bg-warning">
                  <div class="overlay dark ggLoading">
                    <i class="fas fa-3x fa-sync-alt"></i>
                  </div>
                  <div class="inner">
                    <h3 id="currentAwaiting">-</h3>
                    <p>Awaiting results</p>
                  </div>
                  <div class="icon">
                    <i class="fas fa-hourglass-half"></i>
                  </div>
                </div>
              </div>

              <div class="flex-fill py-sm-0 px-md-2">
                <div class="small-box bg-success">
                  <div class="overlay dark ggLoading">
                    <i class="fas fa-3x fa-sync-alt"></i>
                  </div>
                  <div class="inner">
                    <h3 id="currentNegative">-</h3>
                    <p>Negative results</p>
                  </div>
                  <div class="icon">
                    <i class="fas fa-heart"></i>
                  </div>
                </div>
              </div>

              <div class="flex-fill py-sm-0 pl-md-2">
              <!-- <div class="flex-fill px-md-2"> -->
                <div class="small-box bg-danger">
                  <div class="overlay dark ggLoading">
                    <i class="fas fa-3x fa-sync-alt"></i>
                  </div>
                  <div class="inner">
                    <h3 id="currentPositive">-</h3>
                    <p>Positive results</p>
                  </div>
                  <div class="icon">
                    <i class="fas fa-biohazard"></i>
                  </div>
                </div>
              </div>
              
              <!-- <div class="flex-fill pl-md-2">
                <div class="small-box bg-secondary">
                  <div class="overlay dark ggLoading">
                    <i class="fas fa-3x fa-sync-alt"></i>
                  </div>
                  <div class="inner">
                    <h3 id="currentPositive">-</h3>
                    <p>Reported deaths</p>
                  </div>
                  <div class="icon">
                    <i class="fas fa-skull-crossbones"></i>
                  </div>
                </div>
              </div> -->

            </div>
            <!-- ./current-figures-->

            <!-- About data -->
            <div class="row">
              <div class="col">
                <div class="card">
                  <div class="overlay dark ggLoading">
                    <i class="fas fa-3x fa-sync-alt"></i>
                  </div>
                  <div class="card-header">
                    <h3 class="card-title">About The Data</h3>
          
                    <div class="card-tools">
                      <button type="button" class="btn btn-tool" data-card-widget="collapse" data-toggle="tooltip" title="Collapse">
                        <i class="fas fa-minus"></i></button>
                    </div>
                  </div>
                  <div class="card-body">
                    <div class="row">
                      <div class="col-12 col-md-12 col-lg-8 order-2 order-md-1">
                        The coronavirus page on Gov.gg was last updated <strong id="lastUpdated"></strong>. The data on this page is cached for 30 minutes and will next refresh <strong id="nextRefresh"></strong>.
                      </div>
                      <div class="col-12 col-md-12 col-lg-4 order-1 order-md-2">
                        <a href="https://gov.gg/selfisolate" class="btn btn-lg btn-danger btn-block" target="_blank">Should I self-isolate?</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- ./about-data-->

            <div class="row">
              <div class="col">
                <div class="card">
                  <div class="overlay dark ggLoading">
                    <i class="fas fa-3x fa-sync-alt"></i>
                  </div>
                  <div class="card-header">
                    <h5 class="card-title m-0">Tracking Graphs</h5>

                    <div class="card-tools">
                      <ul class="nav nav-pills ml-auto">
                        <li class="nav-item">
                          <a class="nav-link active" href="#sigma-chart" data-toggle="tab">Aggregate</a>
                        </li>
                        <li class="nav-item">
                          <a class="nav-link" href="#delta-chart" data-toggle="tab">Changes</a>
                        </li>
                      </ul>
                    </div>
                  </div>
                  <div class="card-body">
                    <div class="tab-content p-0">
                      <div class="chart tab-pane row active" id="sigma-chart">  
                        <div class="plot col-12" id="tracker_graph"></div>
                        The above graph plots the tracking data publish by Gov.gg.  Each point on the graph represents an update being published to their Coronavirus page, whether or not it is a change in the tracking numbers.
                      </div>
                      <div class="chart tab-pane row" id="delta-chart">
                        <div class="plot col-12" id="changes_graph"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- /.col -->

            </div>
            <!-- /.row -->
          </div>
          <!-- /.container-fluid -->
        </div>
        <!-- /.content -->
      </div>
      <!-- /.content-wrapper -->

      <!-- Main Footer -->
      <footer class="main-footer">
        <!-- To the right -->
        <div class="float-right d-none d-sm-inline">
          Original data source: <a href="https://gov.gg/coronavirus" target="_blank">Gov.gg</a>
        </div>
        <!-- Default to the left -->
        <strong>Copyright &copy; 2020 <a href="https://kodo.gg" target="_blank">Kodo.gg</a>.</strong> All rights reserved.
      </footer>
    </div>
    <!-- ./wrapper -->

    <div class="modal fade" id="modal-about" style="display: none;" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">About This Site</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">×</span>
            </button>
          </div>
          <div class="modal-body">
            <p>This site has been created and is maintained by Adrian Ritchie.  For enquiries about the site, please email: <a href="mailto:ar@kodo.gg?subject=Guernsey%20Covid-19%20Tracker">ar@kodo.gg</a>.</p>
            <p>The source code for the site is available on <a href="https://github.com/adrianritchie/GG_Covid_19" target="_blank">GitHub <i class="fab fa-github"></i></a>.  If you are able to, please submit a pull-request for any enhancements to make this site better.</p>
          </div>
          <div class="modal-footer justify-content-between">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
        <!-- /.modal-content -->
      </div>
      <!-- /.modal-dialog -->
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function() {
        try {
          let app = firebase.app();
          firebase.analytics();

          $.ajax({
            url: "https://us-central1-gg-covid-19.cloudfunctions.net/graphData",
            success: function(result) {
              render_data(result);
            }
          });

          $('#modal-about').on('shown.bs.modal', function (e) {
            firebase.analytics().logEvent('about_modal_shown');
          });
          $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
            firebase.analytics().logEvent('switch_chart', { 'chart' : e.target });
          });
          
        } catch (e) {
          console.error(e);
          document.getElementById("load").innerHTML = "Error loading the Covid tracker.";
        }
      });
    </script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.4.1/js/bootstrap.min.js"
      integrity="sha256-WqU1JavFxSAMcLP2WIOI+GB2zWmShMI82mTpLDcqFUg="
      crossorigin="anonymous"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/3.0.2/js/adminlte.min.js"></script>
  </body>
</html>
